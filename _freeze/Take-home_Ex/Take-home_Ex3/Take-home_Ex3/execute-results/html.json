{
  "hash": "a8e0e9711ede06542ea2301475ce52df",
  "result": {
    "markdown": "---\ntitle: \"Take-home_Ex3: Prototyping Modules for Geospatial Analytics Shiny Application\"\nformat: html\ndate-modified: \"last-modified\"\nexecute:  \n  warning: false\n  freeze: true\n  message: false \n  eval: true \n  echo: true \n  fig-retine: 3\ndate: \"2024-03-24\"\n---\n\n\n# **1. Introduction**\n\nThis take-home exercise will be showcasing the analysis we will be working in our project. Also, it will include the storyboard of our project in terms of the UI design and prototype of our Shiny Application.\n\nIn the following part, I will be analyse the types of recycling facilities in Hong Kong. Further on, I will conduct Network Kernal Density Estimate (NKDE) for our project.\n\n# 2. Analysis on the type of recycling facilities in Hong Kong \n\n### 2.1 Getting Started\n\n\n::: {.cell}\n\n```{.r .cell-code}\npacman::p_load(arrow, lubridate, tidyverse, sf, sfdep, sp, spNetwork, spdep, raster, spatstat, tmap, readxl, plotly)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nosm_basemap <- tm_basemap(server = \"OpenStreetMap.HOT\")\nimagery_basemap <- tm_basemap(server = \"Esri.WorldImagery\")\n```\n:::\n\n\n### 2.2 Importing Data\n\n#### 2.2.1 Aspatial Data\n\n\n::: {.cell}\n\n```{.r .cell-code}\nhk_census <- read_excel(\"data/aspatial/hkcensus.xlsx\")\n```\n:::\n\n\n#### 2.2.2 Geospatial Data\n\n##### 2.2.2.1 Cycling Points in Hong Kong\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncp <- read_csv(\"data/aspatial/hkrecyclepoints.csv\")\n```\n:::\n\n\nChange the geographic location\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncp_sf <- st_as_sf(cp, \n                  coords = c(\"lgt\",\"lat\"), \n                  crs = 4326) %>% \n  st_transform(crs= 2326)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nsummary(cp_sf)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n     cp_id       district_id         address_en        address2_en       \n Min.   :  283   Length:6520        Length:6520        Length:6520       \n 1st Qu.: 3615   Class :character   Class :character   Class :character  \n Median : 6652   Mode  :character   Mode  :character   Mode  :character  \n Mean   : 6127                                                           \n 3rd Qu.: 8516                                                           \n Max.   :10764                                                           \n  waste_type           legend                   geometry   \n Length:6520        Length:6520        POINT        :6520  \n Class :character   Class :character   epsg:2326    :   0  \n Mode  :character   Mode  :character   +proj=tmer...:   0  \n                                                           \n                                                           \n                                                           \n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nplot(st_geometry(cp_sf))\n```\n\n::: {.cell-output-display}\n![](Take-home_Ex3_files/figure-html/unnamed-chunk-7-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ntmap_mode('plot')\ntm_shape(cp_sf)+\n  tm_dots()\n```\n\n::: {.cell-output-display}\n![](Take-home_Ex3_files/figure-html/unnamed-chunk-8-1.png){width=672}\n:::\n:::\n\n\n##### 2.2.2.2 18 Districts in Hong Kong\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndistrict_18 <- st_read(dsn = \"data/geospatial/hk_18Districts/\",\n                       layer = \"HKDistrict18\" )\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nReading layer `HKDistrict18' from data source \n  `C:\\Users\\Kachel Lee\\ka33rina\\IS415GAA\\Take-home_Ex\\Take-home_Ex3\\data\\geospatial\\hk_18Districts' \n  using driver `ESRI Shapefile'\nSimple feature collection with 18 features and 4 fields\nGeometry type: MULTIPOLYGON\nDimension:     XY\nBounding box:  xmin: 12672060 ymin: 2529946 xmax: 12739620 ymax: 2579129\nProjected CRS: WGS 84 / Pseudo-Mercator\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nsf_district_18 <- district_18 %>% st_transform(crs = 2326)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nst_crs(sf_district_18)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nCoordinate Reference System:\n  User input: EPSG:2326 \n  wkt:\nPROJCRS[\"Hong Kong 1980 Grid System\",\n    BASEGEOGCRS[\"Hong Kong 1980\",\n        DATUM[\"Hong Kong 1980\",\n            ELLIPSOID[\"International 1924\",6378388,297,\n                LENGTHUNIT[\"metre\",1]]],\n        PRIMEM[\"Greenwich\",0,\n            ANGLEUNIT[\"degree\",0.0174532925199433]],\n        ID[\"EPSG\",4611]],\n    CONVERSION[\"Hong Kong 1980 Grid\",\n        METHOD[\"Transverse Mercator\",\n            ID[\"EPSG\",9807]],\n        PARAMETER[\"Latitude of natural origin\",22.3121333333333,\n            ANGLEUNIT[\"degree\",0.0174532925199433],\n            ID[\"EPSG\",8801]],\n        PARAMETER[\"Longitude of natural origin\",114.178555555556,\n            ANGLEUNIT[\"degree\",0.0174532925199433],\n            ID[\"EPSG\",8802]],\n        PARAMETER[\"Scale factor at natural origin\",1,\n            SCALEUNIT[\"unity\",1],\n            ID[\"EPSG\",8805]],\n        PARAMETER[\"False easting\",836694.05,\n            LENGTHUNIT[\"metre\",1],\n            ID[\"EPSG\",8806]],\n        PARAMETER[\"False northing\",819069.8,\n            LENGTHUNIT[\"metre\",1],\n            ID[\"EPSG\",8807]]],\n    CS[Cartesian,2],\n        AXIS[\"northing (N)\",north,\n            ORDER[1],\n            LENGTHUNIT[\"metre\",1]],\n        AXIS[\"easting (E)\",east,\n            ORDER[2],\n            LENGTHUNIT[\"metre\",1]],\n    USAGE[\n        SCOPE[\"Cadastre, engineering survey, topographic mapping (large scale).\"],\n        AREA[\"China - Hong Kong - onshore and offshore.\"],\n        BBOX[22.13,113.76,22.58,114.51]],\n    ID[\"EPSG\",2326]]\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nplot(st_geometry(sf_district_18))\n```\n\n::: {.cell-output-display}\n![](Take-home_Ex3_files/figure-html/unnamed-chunk-12-1.png){width=672}\n:::\n:::\n\n\n##### 2.2.2.3 Road Data in Hong Kong\n\n\n::: {.cell}\n\n```{.r .cell-code}\nroad_data <- st_read(dsn = \"data/geospatial/china-latest-free.shp\", \n                     layer = \"gis_osm_roads_free_1\")\n```\n:::\n\n\nTransform the Data into Hong Kong Projection System\n\n\n::: {.cell}\n\n```{.r .cell-code}\nroad_data_2326 <- st_transform(road_data, 2326)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nroads_in_hk <- st_intersection(road_data_2326, sf_district_18)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nwrite_rds(roads_in_hk, \"data/rds/sf_roads_in_hk.rds\")\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nroads_in_hk <- read_rds(\"data/rds/sf_roads_in_hk.rds\")\n```\n:::\n\n\n### 2.3 Types of Recycling Points in Hong Kong\n\n\n::: {.cell}\n\n```{.r .cell-code}\nunique_legends <- unique(cp_sf$legend)\n\n# Print or inspect the unique values\nprint(unique_legends)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] \"Recycling Bins at Public Place\"                                    \n[2] \"Recycling Spots\"                                                   \n[3] \"Private Collection Points (e.g. housing estates, shopping centres)\"\n[4] \"NGO Collection Points\"                                             \n[5] \"Recycling Stations/Recycling Stores\"                               \n[6] \"Street Corner Recycling Shops\"                                     \n[7] NA                                                                  \n[8] \"Smart Bin\"                                                         \n```\n:::\n:::\n\n\nThere are 7 different types of recycling points in Hong Kong which are:\n\n| Types of Recycling Points in Hong Kong                             |\n|--------------------------------------------------------------------|\n| Recycling Bins at Public Place                                     |\n| Recycling Spots                                                    |\n| Private Collection Points (e.g. housing estates, shopping centres) |\n| NGO Collection Points                                              |\n| Recycling Stations/ Recycling Stores                               |\n| Street Corner Recycling Shops                                      |\n| Smart Bin                                                          |\n\nIn order to join the data, we need to mutate the values of district_id in cp_sf in order to match with the values of ENAME in sf_district_id.\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncp_sf_1 <- cp_sf %>%\n  mutate(district_id = toupper(str_replace_all(district_id, \"_\", \" \")))\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nrecycling_bins <- subset(cp_sf_1, legend == \"Recycling Bins at Public Place\")\nrecycling_spots <- subset(cp_sf_1, legend == \"Recycling Spots\")\nprivate_collection_points <- subset(cp_sf_1, legend == \"Private Collection Points (e.g. housing estates, shopping centres)\")\nngo_collection_points <- subset(cp_sf_1, legend == \"NGO Collection Points\")\nrecycling_stations <- subset(cp_sf_1, legend == \"Recycling Stations/Recycling Stores\")\nstreet_corner_recycling_shops <- subset(cp_sf_1, legend == \"Street Corner Recycling Shops\")\nsmart_bins <- subset(cp_sf_1, legend == \"Smart Bin\")\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nrecycling_spots_cp <- st_join(sf_district_18, recycling_spots)\nngo_cp <- st_join(sf_district_18, ngo_collection_points)\npcp_joined_data <- st_join(sf_district_18, private_collection_points)\nrecycling_bins_cp <- st_join(sf_district_18, recycling_bins)\nrecycling_stations_cp <- st_join(sf_district_18, recycling_stations)\nstreet_corner_cp <- st_join(sf_district_18, street_corner_recycling_shops)\nsmart_bins_cp <- st_join(sf_district_18, smart_bins)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nprivate_collection_points_by_district <- pcp_joined_data %>%\n  group_by(ENAME) %>%\n  summarize(total_pcp = n())\n\nngo_cp_by_district <- ngo_cp %>%\n  group_by(ENAME) %>%\n  summarize(total_ngo_cp = n())\n\nrecycling_spots_by_district <- recycling_spots_cp %>%\n  group_by(ENAME) %>%\n  summarize(total_recycling_spots = n())\n\nrecycling_bins_by_district <- recycling_bins_cp %>%\n  group_by(ENAME) %>%\n  summarize(total_recycling_bins = n())\n\nrecycling_stations_by_district <- recycling_stations_cp %>%\n  group_by(ENAME) %>%\n  summarize(total_recycling_stations = n())\n\nstreet_corner_shops_by_district <- street_corner_cp %>%\n  group_by(ENAME) %>%\n  summarize(total_street_corner = n())\n\nsmart_bins_by_district <- smart_bins_cp %>%\n  group_by(ENAME) %>%\n  summarize(total_smart_bins = n())\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\npcp_map <- tm_shape(private_collection_points_by_district) +\n  tm_fill(col = \"total_pcp\") +\n  tm_borders() +\n  tm_layout(legend.show = TRUE, main.title = \"Distribution of Private Collection Points by District\",main.title.position = \"center\", main.title.size = 0.75)+\n  tm_scale_bar()\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nngo_cp_map <- tm_shape(ngo_cp_by_district) +\n  tm_fill(col = \"total_ngo_cp\") +\n  tm_borders() +\n  tm_layout(legend.show = TRUE, main.title = \"Distribution of NGO Points by District\", main.title.position = \"center\", main.title.size = 0.75)+\n  tm_scale_bar()\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nrecycling_spots_map <- tm_shape(recycling_spots_by_district) +\n  tm_fill(col = \"total_recycling_spots\") +\n  tm_borders() +\n  tm_layout(legend.show = TRUE, main.title = \"Distribution of Recycling Spots by District\",main.title.position = \"center\", main.title.size = 0.75)+\n  tm_scale_bar()\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nrecycling_bins_map <- tm_shape(recycling_bins_by_district) +\n  tm_fill(col = \"total_recycling_bins\") +\n  tm_borders() +\n  tm_layout(legend.show = TRUE, main.title = \"Distribution of Recycling Bins by District\", main.title.position = \"center\", main.title.size = 0.75)+\n  tm_scale_bar()\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nrecycling_stations_map <- tm_shape(recycling_stations_by_district) +\n  tm_fill(col = \"total_recycling_stations\") +\n  tm_borders() +\n  tm_layout(legend.show = TRUE, main.title = \"Distribution of Recycling Stations by District\", main.title.position = \"center\", main.title.size = 0.75)+\n  tm_scale_bar()\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nstreet_corner_shops_map <- tm_shape(street_corner_shops_by_district) +\n  tm_fill(col = \"total_street_corner\") +\n  tm_borders() +\n  tm_layout(legend.show = TRUE,main.title = \"Distribution of Street Corner Shops by District\", main.title.position = \"center\", main.title.size = 0.75)+\n  tm_scale_bar()\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nsmart_bin_map <- tm_shape(smart_bins_by_district) +\n  tm_fill(col = \"total_smart_bins\") +\n  tm_borders() +\n  tm_layout(legend.show = TRUE,main.title = \"Distribution of Smart Bins by District\",main.title.position = \"center\", main.title.size = 0.75)+\n  tm_scale_bar()\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nsmart_bin_map\n```\n\n::: {.cell-output-display}\n![](Take-home_Ex3_files/figure-html/unnamed-chunk-30-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ntmap_arrange(pcp_map,recycling_spots_map, recycling_bins_map, ncol=2)\n```\n\n::: {.cell-output-display}\n![](Take-home_Ex3_files/figure-html/unnamed-chunk-31-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ntmap_arrange(ngo_cp_map, recycling_stations_map, street_corner_shops_map, smart_bin_map, ncol = 2)\n```\n\n::: {.cell-output-display}\n![](Take-home_Ex3_files/figure-html/unnamed-chunk-32-1.png){width=672}\n:::\n:::\n\n\n#### Private Collection Points \n\n\n::: {.cell}\n\n```{.r .cell-code}\nwm_q_pcp <- private_collection_points_by_district %>%\n  mutate(nb = st_contiguity(geometry, queen = TRUE),\n         wt = st_weights(nb,\n                         style = \"W\",\n                         allow_zero = TRUE),\n         .before = 1) \nwm_q_pcp\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nSimple feature collection with 18 features and 4 fields\nGeometry type: MULTIPOLYGON\nDimension:     XY\nBounding box:  xmin: 801026 ymin: 801678 xmax: 863539.9 ymax: 846903.1\nProjected CRS: Hong Kong 1980 Grid System\n# A tibble: 18 × 5\n   nb        wt        ENAME             total_pcp                      geometry\n * <nb>      <list>    <chr>                 <int>            <MULTIPOLYGON [m]>\n 1 <int [2]> <dbl [2]> CENTRAL & WESTERN       414 (((833047.3 816838.9, 833488…\n 2 <int [2]> <dbl [2]> EASTERN                 200 (((843535.7 812736.3, 843530…\n 3 <int [1]> <dbl [1]> ISLANDS                  46 (((810029 801683.4, 810019.4…\n 4 <int [5]> <dbl [5]> KOWLOON CITY            243 (((836281 823326.3, 836283 8…\n 5 <int [3]> <dbl [3]> KWAI TSING               87 (((827834 820693.1, 827834 8…\n 6 <int [3]> <dbl [3]> KWUN TONG               119 (((843155.9 816368.9, 843154…\n 7 <int [2]> <dbl [2]> NORTH                    97 (((852615.5 841161.9, 852615…\n 8 <int [4]> <dbl [4]> SAI KUNG                163 (((840825.4 823785.4, 840827…\n 9 <int [7]> <dbl [7]> SHA TIN                 194 (((839924.4 832031.6, 839924…\n10 <int [4]> <dbl [4]> SHAM SHUI PO            190 (((834919.6 823272.4, 834921…\n11 <int [3]> <dbl [3]> SOUTHERN                181 (((830176.1 815000.2, 830255…\n12 <int [5]> <dbl [5]> TAI PO                  121 (((846104.6 830686.6, 846265…\n13 <int [6]> <dbl [6]> TSUEN WAN                92 (((821762.8 819430, 821765.7…\n14 <int [2]> <dbl [2]> TUEN MUN                165 (((811619.1 831909.9, 811639…\n15 <int [3]> <dbl [3]> WAN CHAI                198 (((838663.3 815002.8, 838700…\n16 <int [4]> <dbl [4]> WONG TAI SIN             82 (((836530.5 823327.5, 836533…\n17 <int [2]> <dbl [2]> YAU TSIM MONG           116 (((835145.2 817859.4, 835137…\n18 <int [4]> <dbl [4]> YUEN LONG               178 (((811708.8 831974.4, 811719…\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nset.seed(1234)\nglobal_moran_perm(wm_q_pcp$total_pcp,\n                       wm_q_pcp$nb,\n                       wm_q_pcp$wt,\n                  zero.policy = TRUE,\n                  nsim = 999)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\n\tMonte-Carlo simulation of Moran I\n\ndata:  x \nweights: listw  \nnumber of simulations + 1: 1000 \n\nstatistic = 0.16065, observed rank = 934, p-value = 0.132\nalternative hypothesis: two.sided\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nlisa_pcp <- wm_q_pcp %>% \n  mutate(local_moran = local_moran(\n    total_pcp, nb, wt, zero.policy = TRUE, nsim = 99),\n         .before = 1) %>%\n  unnest(local_moran)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nlisa_sig_pcp <- lisa_pcp  %>%\n  filter(p_ii < 0.05)\n\ntmap_mode(\"plot\")\ntm_shape(lisa_pcp) +\n  tm_polygons() +\n  tm_borders(alpha = 0.7) +\ntm_shape(lisa_pcp) +\n  tm_fill(\"mean\") + \n  tm_borders(alpha = 0.4)\n```\n\n::: {.cell-output-display}\n![](Take-home_Ex3_files/figure-html/unnamed-chunk-36-1.png){width=672}\n:::\n:::\n\n\n#### Recycling Spots \n\n\n::: {.cell}\n\n```{.r .cell-code}\nwm_q_rspots <- recycling_spots_by_district %>%\n  mutate(nb = st_contiguity(geometry, queen = TRUE),\n         wt = st_weights(nb,\n                         style = \"W\",\n                         allow_zero = TRUE),\n         .before = 1) \nwm_q_rspots\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nSimple feature collection with 18 features and 4 fields\nGeometry type: MULTIPOLYGON\nDimension:     XY\nBounding box:  xmin: 801026 ymin: 801678 xmax: 863539.9 ymax: 846903.1\nProjected CRS: Hong Kong 1980 Grid System\n# A tibble: 18 × 5\n   nb        wt        ENAME     total_recycling_spots                  geometry\n * <nb>      <list>    <chr>                     <int>        <MULTIPOLYGON [m]>\n 1 <int [2]> <dbl [2]> CENTRAL …                    12 (((833047.3 816838.9, 83…\n 2 <int [2]> <dbl [2]> EASTERN                      11 (((843535.7 812736.3, 84…\n 3 <int [1]> <dbl [1]> ISLANDS                       6 (((810029 801683.4, 8100…\n 4 <int [5]> <dbl [5]> KOWLOON …                     7 (((836281 823326.3, 8362…\n 5 <int [3]> <dbl [3]> KWAI TSI…                     4 (((827834 820693.1, 8278…\n 6 <int [3]> <dbl [3]> KWUN TONG                     8 (((843155.9 816368.9, 84…\n 7 <int [2]> <dbl [2]> NORTH                         8 (((852615.5 841161.9, 85…\n 8 <int [4]> <dbl [4]> SAI KUNG                      6 (((840825.4 823785.4, 84…\n 9 <int [7]> <dbl [7]> SHA TIN                       7 (((839924.4 832031.6, 83…\n10 <int [4]> <dbl [4]> SHAM SHU…                     7 (((834919.6 823272.4, 83…\n11 <int [3]> <dbl [3]> SOUTHERN                      8 (((830176.1 815000.2, 83…\n12 <int [5]> <dbl [5]> TAI PO                        9 (((846104.6 830686.6, 84…\n13 <int [6]> <dbl [6]> TSUEN WAN                     3 (((821762.8 819430, 8217…\n14 <int [2]> <dbl [2]> TUEN MUN                      7 (((811619.1 831909.9, 81…\n15 <int [3]> <dbl [3]> WAN CHAI                     12 (((838663.3 815002.8, 83…\n16 <int [4]> <dbl [4]> WONG TAI…                     4 (((836530.5 823327.5, 83…\n17 <int [2]> <dbl [2]> YAU TSIM…                    11 (((835145.2 817859.4, 83…\n18 <int [4]> <dbl [4]> YUEN LONG                     9 (((811708.8 831974.4, 81…\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nset.seed(1234)\nglobal_moran_perm(wm_q_rspots$total_recycling_spots,\n                       wm_q_rspots$nb,\n                       wm_q_rspots$wt,\n                  zero.policy = TRUE,\n                  nsim = 999)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\n\tMonte-Carlo simulation of Moran I\n\ndata:  x \nweights: listw  \nnumber of simulations + 1: 1000 \n\nstatistic = 0.42312, observed rank = 991, p-value = 0.018\nalternative hypothesis: two.sided\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nlisa_rspots <- wm_q_rspots %>% \n  mutate(local_moran = local_moran(\n    total_recycling_spots, nb, wt, zero.policy = TRUE, nsim = 99),\n         .before = 1) %>%\n  unnest(local_moran)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nlisa_sig_rspots <- lisa_rspots  %>%\n  filter(p_ii < 0.05)\n\ntmap_mode(\"plot\")\ntm_shape(lisa_rspots) +\n  tm_polygons() +\n  tm_borders(alpha = 0.7) +\ntm_shape(lisa_rspots) +\n  tm_fill(\"mean\") + \n  tm_borders(alpha = 0.4)\n```\n\n::: {.cell-output-display}\n![](Take-home_Ex3_files/figure-html/unnamed-chunk-40-1.png){width=672}\n:::\n:::\n\n\n### 2.4 NKDE\n\n\n::: {.cell}\n\n```{.r .cell-code}\nunique_types <- unique(st_geometry_type(roads_in_hk))\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nprint(unique_types)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] LINESTRING      MULTILINESTRING\n18 Levels: GEOMETRY POINT LINESTRING POLYGON MULTIPOINT ... TRIANGLE\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nif (\"LINESTRING\" %in% unique_types) {\n  roads_in_hk <- st_cast(roads_in_hk, \"LINESTRING\")\n} else {\n  # handle the case when no linestrings are found\n  stop(\"No linestrings found in roads_in_hk\")\n}\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nunique_types <- unique(st_geometry_type(roads_in_hk))\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nroads_in_hk <- roads_in_hk[st_geometry_type(roads_in_hk) == \"LINESTRING\", ]\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nlixels_hk <- lixelize_lines(roads_in_hk,750, mindist = 375)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nsamples_hk <- lines_center(lixels_hk)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ndensities <- nkde(roads_in_hk, \n                  events = cp_sf,\n                  w = rep(1,nrow(cp_sf)),\n                  samples = samples_hk,\n                  kernel_name = \"quartic\",\n                  bw = 300, \n                  div= \"bw\", \n                  method = \"simple\", \n                  digits = 1, \n                  tol = 1,\n                  grid_shape = c(1,1), \n                  max_depth = 8,\n                  agg = 5, #we aggregate events within a 5m radius (faster calculation)\n                  sparse = TRUE,\n                  verbose = FALSE)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nsamples_hk$density <- densities\nlixels_hk$density <- densities\n\nsamples_hk$density <- samples_tm$density*1000\nlixels_hk$density <- lixels_tm$density*1000\n\ntmap_mode(\"view\")\ntm_shape(lixels_hk)+\n  tm_lines(col=\"density\")+\ntm_shape(cp_sf)+\n  tm_dots(alpha=0.1) +\ntm_basemap(\"OpenStreetMap\")\n```\n:::\n\n\n# **3. Storyboard**\n\nFor our project, we will be analysing the recycling points in Hong Kong and observe its distribution over the 18 districts in Hong Kong. Afterwards, we will further analyse on the districts with high adn low density. We hope to seek to identify the gaps in coverage and areas with lack of recycling facilities. Therefore, in our application, we hope to visualize the recycling facilities in each district.\n\nThe next part will go through the features and design of our application.\n\n# **4. UI Design & Prototype**\n\nThis is will be the UI design of our Shiny App.\n\n### Home Page\n\n![](images/clipboard-3889418583.png)\n\n### Visualization Page\n\nThis will be the Visualization Tab where users are able to have idea of the locations of recycling points. We have include some interaction features such as drop-down menu for them to select their desirable districts and recyclables that they want to recycle.\n\n![](images/clipboard-4162415444.png)\n\n## Analysis Pages: SPAA & NETSPAA\n\nThe following 2 pages also include interactive feature such as drop-down menu for the districts that we do our analysis on.\n\n![](images/clipboard-805621792.png)\n\n![](images/clipboard-2302619658.png)\n",
    "supporting": [
      "Take-home_Ex3_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}