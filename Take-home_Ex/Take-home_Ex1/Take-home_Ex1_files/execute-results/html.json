{
  "hash": "ccb50323099dc2b6b2e78f2c386c32c8",
  "result": {
    "markdown": "---\ntitle: \"Take-home_Ex1\"\nexecute:  \n  warning: false\ndate: \"2024-02-03\"\n---\n\n\n# Getting Started\n\n\n::: {.cell}\n\n```{.r .cell-code}\npacman::p_load(arrow, lubridate, tidyverse,maptools, sf, raster, spatstat, tmap)\n```\n:::\n\n\n## 1. Loading of Data\n\n### 1.1 Loading of grab data frame\n\n\n::: {.cell}\n\n```{.r .cell-code}\ngrab_df <- read_parquet(\"data/GrabPosisi/part-00000-8bbff892-97d2-4011-9961-703e38972569.c000.snappy.parquet\")\n```\n:::\n\n\n### 1.2 Loading of Road data set from OpenStreetMap\n\n\n::: {.cell}\n\n:::\n\n\n### 1.3 Loading of Master Plan 2019 Subzone Boundary (No Sea) from Data.gov.sg\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmpsz <- st_read(dsn = \"data/MPSZ-2019\", \n                layer = \"MPSZ-2019\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nReading layer `MPSZ-2019' from data source \n  `C:\\Users\\Kachel Lee\\ka33rina\\IS415-GAA\\Take-home_Ex\\Take-home_Ex1\\data\\MPSZ-2019' \n  using driver `ESRI Shapefile'\nSimple feature collection with 332 features and 6 fields\nGeometry type: MULTIPOLYGON\nDimension:     XY\nBounding box:  xmin: 103.6057 ymin: 1.158699 xmax: 104.0885 ymax: 1.470775\nGeodetic CRS:  WGS 84\n```\n:::\n:::\n\n\n**Checking the Coordination of mpsz_sf**\n\n\n::: {.cell}\n\n```{.r .cell-code}\nst_crs(mpsz)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nCoordinate Reference System:\n  User input: WGS 84 \n  wkt:\nGEOGCRS[\"WGS 84\",\n    DATUM[\"World Geodetic System 1984\",\n        ELLIPSOID[\"WGS 84\",6378137,298.257223563,\n            LENGTHUNIT[\"metre\",1]]],\n    PRIMEM[\"Greenwich\",0,\n        ANGLEUNIT[\"degree\",0.0174532925199433]],\n    CS[ellipsoidal,2],\n        AXIS[\"latitude\",north,\n            ORDER[1],\n            ANGLEUNIT[\"degree\",0.0174532925199433]],\n        AXIS[\"longitude\",east,\n            ORDER[2],\n            ANGLEUNIT[\"degree\",0.0174532925199433]],\n    ID[\"EPSG\",4326]]\n```\n:::\n:::\n\n\n**This is a wrong EPSG code because the correct EPSG code for svy21 should be 3414. Since it indicates that EPSG is 4326, we need to change the EPSG code into 3414.**\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmpsz3414 <- st_transform(mpsz, 3414)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nst_crs(mpsz3414)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nCoordinate Reference System:\n  User input: EPSG:3414 \n  wkt:\nPROJCRS[\"SVY21 / Singapore TM\",\n    BASEGEOGCRS[\"SVY21\",\n        DATUM[\"SVY21\",\n            ELLIPSOID[\"WGS 84\",6378137,298.257223563,\n                LENGTHUNIT[\"metre\",1]]],\n        PRIMEM[\"Greenwich\",0,\n            ANGLEUNIT[\"degree\",0.0174532925199433]],\n        ID[\"EPSG\",4757]],\n    CONVERSION[\"Singapore Transverse Mercator\",\n        METHOD[\"Transverse Mercator\",\n            ID[\"EPSG\",9807]],\n        PARAMETER[\"Latitude of natural origin\",1.36666666666667,\n            ANGLEUNIT[\"degree\",0.0174532925199433],\n            ID[\"EPSG\",8801]],\n        PARAMETER[\"Longitude of natural origin\",103.833333333333,\n            ANGLEUNIT[\"degree\",0.0174532925199433],\n            ID[\"EPSG\",8802]],\n        PARAMETER[\"Scale factor at natural origin\",1,\n            SCALEUNIT[\"unity\",1],\n            ID[\"EPSG\",8805]],\n        PARAMETER[\"False easting\",28001.642,\n            LENGTHUNIT[\"metre\",1],\n            ID[\"EPSG\",8806]],\n        PARAMETER[\"False northing\",38744.572,\n            LENGTHUNIT[\"metre\",1],\n            ID[\"EPSG\",8807]]],\n    CS[Cartesian,2],\n        AXIS[\"northing (N)\",north,\n            ORDER[1],\n            LENGTHUNIT[\"metre\",1]],\n        AXIS[\"easting (E)\",east,\n            ORDER[2],\n            LENGTHUNIT[\"metre\",1]],\n    USAGE[\n        SCOPE[\"Cadastre, engineering survey, topographic mapping.\"],\n        AREA[\"Singapore - onshore and offshore.\"],\n        BBOX[1.13,103.59,1.47,104.07]],\n    ID[\"EPSG\",3414]]\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nplot(mpsz3414)\n```\n\n::: {.cell-output-display}\n![](Take-home_Ex1_files/figure-html/unnamed-chunk-8-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nplot(st_geometry(mpsz3414))\n```\n\n::: {.cell-output-display}\n![](Take-home_Ex1_files/figure-html/unnamed-chunk-9-1.png){width=672}\n:::\n:::\n\n\n## 2. Extracting Geospatial Data Layer\n\n### 2.1 Extracting Grab taxi locations by origin\n\n\n::: {.cell}\n\n```{.r .cell-code}\ngrab_df$pingtimstamp <- as_datetime(grab_df$pingtimestamp)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ngrab_origin_df <- grab_df %>% \n  group_by(trj_id) %>%\n  arrange(pingtimestamp) %>%\n  filter(row_number()==1) %>%\n  mutate(weekday = wday(pingtimstamp,\n                        label = TRUE,\n                        abbr = TRUE),\n         start_hr = factor(hour(pingtimestamp)),\n         day = factor(mday(pingtimestamp)))\n```\n:::\n\n::: {.cell}\n\n:::\n\n\n### 2.2 Extracting Road Layer within Singapore excluding outer islands\n\n\n::: {.cell}\n\n:::\n\n::: {.cell}\n\n:::\n\n\n### 2.3 Extracting Singapore boundary layer excluding outer islands\n\n\n::: {.cell}\n\n```{.r .cell-code}\nouter_islands <- mpsz3414[grep(\"island\", mpsz3414$PLN_AREA_N, ignore.case = TRUE), ]\nprint(outer_islands)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nSimple feature collection with 6 features and 6 fields\nGeometry type: MULTIPOLYGON\nDimension:     XY\nBounding box:  xmin: 8012.578 ymin: 15748.72 xmax: 56396.44 ymax: 46931.6\nProjected CRS: SVY21 / Singapore TM\n                  SUBZONE_N SUBZONE_C            PLN_AREA_N PLN_AREA_C\n4   JURONG ISLAND AND BUKOM    WISZ01       WESTERN ISLANDS         WI\n7                    SUDONG    WISZ03       WESTERN ISLANDS         WI\n8                   SEMAKAU    WISZ02       WESTERN ISLANDS         WI\n9            SOUTHERN GROUP    SISZ02      SOUTHERN ISLANDS         SI\n10                  SENTOSA    SISZ01      SOUTHERN ISLANDS         SI\n304   NORTH-EASTERN ISLANDS    NESZ01 NORTH-EASTERN ISLANDS         NE\n             REGION_N REGION_C                       geometry\n4         WEST REGION       WR MULTIPOLYGON (((14557.7 304...\n7         WEST REGION       WR MULTIPOLYGON (((15772.59 21...\n8         WEST REGION       WR MULTIPOLYGON (((19843.41 21...\n9      CENTRAL REGION       CR MULTIPOLYGON (((30870.53 22...\n10     CENTRAL REGION       CR MULTIPOLYGON (((26879.04 26...\n304 NORTH-EAST REGION      NER MULTIPOLYGON (((52567.44 46...\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nplot(outer_islands)\n```\n\n::: {.cell-output-display}\n![](Take-home_Ex1_files/figure-html/unnamed-chunk-16-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nmerged_map <- st_union(mpsz3414, outer_islands)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nplot(merged_map)\n```\n\n::: {.cell-output-display}\n![](Take-home_Ex1_files/figure-html/unnamed-chunk-18-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nmap_without_outer_islands <- st_difference(mpsz3414, st_union(outer_islands))\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nplot(map_without_outer_islands)\n```\n\n::: {.cell-output-display}\n![](Take-home_Ex1_files/figure-html/unnamed-chunk-20-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nmap_without_outer_islands_data <- st_sf(geometry = map_without_outer_islands)\n```\n:::\n\n\n## 3. Traditional Kernel Density Estimation layers\n\n\n::: {.cell}\n\n:::\n\n::: {.cell}\n\n:::\n\n\n## 4. Network Kernel Density Estimation (NKDE) or Temporal Network Kernel Density Estimation (TNKDE)\n\n## 5. Kernel density layers on openstreetmap of Singapore using tmap\n\n## 6. Describe the spatial patterns revealed by the kernel density maps\n",
    "supporting": [
      "Take-home_Ex1_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}